<div class="container">
  <div class="content">
    <mat-progress-spinner class="spinner" color="primary" mode="indeterminate"
      [style.visibility]="showProgress ? 'visible' : 'hidden'">
    </mat-progress-spinner>
    <h1>Start Account Recovery</h1>
    <div *ngIf="!error">
      <p>Recovery is used to regain access to your user identity if you
        lost your Quick Crypt passkeys. Recovery removes all existing
        passkeys from Quick Crypt and creates a new passkey for you.
        You should also delete the removed passkeys from your passkey managment tool.
        Once your new passky is created, you will
        be able decrypt information you previously encrypted.
      </p>
      <p *ngIf="currentUserName && !authenticated">
        There is an existing Quick Crypt user on this system called <b>"{{currentUserName}}"</b>.
        Instead of starting the recover process, you may want to try
        <a href="javascript:void(null);" role="button" (click)="onClickSignin()">
          signing in as <b>{{currentUserName}}</b>
        </a>
      </p>
      <p *ngIf="authenticated && selfRecovery">
        You are currently signed in as <b>"{{currentUserName}}"</b>, which this recovery link
        if for. Recovering this user
        identity will remove all existing passkeys and then create a new one.
        If you do not need to recover this user, you can
        <a routerLink="/">continue to encrypt and decrypt data</a>.
      </p>
      <p *ngIf="authenticated && !selfRecovery">
        You are currently signed in as <b>"{{currentUserName}}"</b>, but this recovery link
        is for a different user. If you start the recovery process, you will be signed out
        and guided to create a new passkey for the recovered user identity.
      </p>

      <div class="button-host">
      <button mat-raised-button (click)="onClickStartRecovery($event)" color="primary">
        Start the recovery process
      </button>
      </div>
    </div>
    <div *ngIf="error">
      <p>
        The recovery link {{validRecoveryLink ? 'did not work' : 'is not valid'}}<span
          [style.visibility]="error ? 'visible' : 'hidden'">
          because: <b>{{error}}</b></span>.
      </p>
      <p>
        Make sure you are using the recovery link that was provided to you when you created
        your user credentials and try again.
      </p>
      <p>
        If you lost both your passkey and your recovery link, there is no way to regain
        access to existing user credentials or decrypt data that you encrypted previously. You can
        create a new Quick Crypt user, but the new user will not be able to decrypt already
        encypted data. If you locate the recovery link after creating a new user, you can
        still use it to regain access to the original user credentials later.
      </p>
      <p *ngIf="currentUserName && !authenticated">
        There is an existing Quick Crypt user on this system called <b>"{{currentUserName}}"</b>.
        Instead of starting the recover process, you may want to try
        <a href="javascript:void(null);" role="button" (click)="onClickSignin()">
          signing in as <b>{{currentUserName}}</b>
        </a>
      </p>
      <p *ngIf="authenticated">
        You are currently signed in as <b>"{{currentUserName}}"</b>.
        If you do not need to recover this user, you can
        <a routerLink="/">continue to encrypt and decrypt data</a>.
      </p>
      <div class="button-host">
        <a [routerLink]="'/newuser'">
        <button mat-raised-button color="primary">
          Create a new user from scratch
        </button>
      </a>
      <button mat-raised-button *ngIf="validRecoveryLink"
        (click)="onClickStartRecovery($event)" color="primary" class="button2">
        Try the recovery process again
      </button>
      </div>
    </div>
  </div>
</div>